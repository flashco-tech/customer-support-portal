{
  "pluginType": "DB",
  "pluginId": "postgres-plugin",
  "unpublishedAction": {
    "name": "QueryReferee",
    "datasource": {
      "name": "Prod Postgres Reader",
      "pluginId": "postgres-plugin",
      "messages": [],
      "isAutoGenerated": false,
      "id": "Prod Postgres Reader",
      "deleted": false,
      "policies": [],
      "userPermissions": []
    },
    "pageId": "Customer Referral Details",
    "actionConfiguration": {
      "timeoutInMillisecond": 15000,
      "paginationType": "NONE",
      "encodeParamsToggle": true,
      "body": "with referee_transaction_base as (\n    select \n        t.user_id, \n        rpl.amount as referee_user_amount, \n        rpl.description as referee_user_description, \n        rpl.created_at as referee_rewared_received_on,\n        meta_info->'type' as transaction_type\n    from rewards.transactions t \n    left join rewards.rewards_point_ledger rpl \n        on t.id = rpl.transaction_id\n    where meta_info->'type'='\"REFERRAL\"' and meta_info->'metaInfo'->>'type'<>'REFERRAL'\n)\nselect \n    uic.user_id as referrer_user_id, \n    ui.user_id as referee_user_id, \n    ce.email_address as referee_email_address,\n    r2.referee_user_amount,\n    r2.referee_rewared_received_on\nfrom user_invite_codes uic \nleft join public.user_invitation ui \n    on cast(uic.id as text) = cast(ui.user_invite_code_id as text)\nleft join public.customer_email ce\n    on ui.user_id = ce.customer_id\n    and ce.email_provider='FMAIL'\nleft join referee_transaction_base r2 \n    on cast(ui.user_id as text) = cast(r2.user_id as text)\nwhere uic.user_invite_count>0 and uic.user_id= {{InputFlashUserUUID.inputText}} and uic.type = 'REFERRAL'",
      "selfReferencingDataPaths": [],
      "pluginSpecifiedTemplates": [
        {
          "value": true
        }
      ]
    },
    "executeOnLoad": false,
    "dynamicBindingPathList": [
      {
        "key": "body"
      }
    ],
    "isValid": true,
    "invalids": [],
    "messages": [],
    "jsonPathKeys": [
      "InputFlashUserUUID.inputText"
    ],
    "userSetOnLoad": true,
    "confirmBeforeExecute": false,
    "policies": [],
    "userPermissions": []
  },
  "id": "Customer Referral Details_QueryReferee",
  "deleted": false,
  "gitSyncId": "64bf8f196d35216bd860d71a_6513d8ef728f36234b852134"
}