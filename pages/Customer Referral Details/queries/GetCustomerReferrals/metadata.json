{
  "pluginType": "DB",
  "pluginId": "postgres-plugin",
  "unpublishedAction": {
    "name": "GetCustomerReferrals",
    "datasource": {
      "name": "Prod Postgres Reader",
      "pluginId": "postgres-plugin",
      "messages": [],
      "isAutoGenerated": false,
      "id": "Prod Postgres Reader",
      "deleted": false,
      "policies": [],
      "userPermissions": []
    },
    "pageId": "Customer Referral Details",
    "actionConfiguration": {
      "timeoutInMillisecond": 10000,
      "paginationType": "NONE",
      "encodeParamsToggle": true,
      "body": "SELECT query1.referred_by, query2.email_address as referred_by_email_address, query1.referred_friend_id, query3.email_address as referred_friend_email_address\nFROM (\n    WITH cte AS (\n        SELECT customer_id\n        FROM customer_email\n        WHERE email_address = {{this.params.emailId}}\n    )\n    SELECT uic.user_id as referred_by, ui.user_id as referred_friend_id \n    FROM user_invite_codes uic \n    JOIN user_invitation ui ON ui.user_invite_code_id = uic.id \n    WHERE uic.type='REFERRAL' AND uic.user_id in (SELECT customer_id FROM cte)\n) as query1 \nJOIN (\n    SELECT customer_id, email_address \n    FROM customer_email\n    WHERE email_provider = 'FMAIL'\n) as query2 ON query1.referred_by = query2.customer_id\nJOIN (\n    SELECT customer_id, email_address \n    FROM customer_email\n    WHERE email_provider = 'FMAIL'\n) as query3 ON query1.referred_friend_id = query3.customer_id;\n",
      "selfReferencingDataPaths": [],
      "pluginSpecifiedTemplates": [
        {
          "value": true
        }
      ]
    },
    "executeOnLoad": true,
    "dynamicBindingPathList": [
      {
        "key": "body"
      }
    ],
    "isValid": true,
    "invalids": [],
    "messages": [],
    "jsonPathKeys": [
      "this.params.emailId"
    ],
    "userSetOnLoad": false,
    "confirmBeforeExecute": false,
    "policies": [],
    "userPermissions": []
  },
  "id": "Customer Referral Details_GetCustomerReferrals",
  "deleted": false,
  "gitSyncId": "64bf8f196d35216bd860d71a_64bf932d6d35216bd860dbaf"
}